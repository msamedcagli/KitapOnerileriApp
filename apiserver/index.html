<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kitap Önerilerim - Kitap Keşif Platformu</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5e7c4 0%, #dfcf9c 40%, #b5916a 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 40px;
      color: #ffffff;
    }

    .header h1 {
      font-size: 3rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.95;
    }

    /* Book Sections */
    .book-section {
      background: #F5F5DC;
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(139, 69, 19, 0.3);
      border: 2px solid #DEB887;
    }

    .section-title {
      font-size: 2rem;
      margin-bottom: 25px;
      color: #8B4513;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i {
      color: #A0522D;
    }

    /* Horizontal Scrollable Book Row */
    .book-row {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding: 10px 0;
      scrollbar-width: thin;
      scrollbar-color: #A0522D #F5F5DC;
      scroll-behavior: smooth;
      position: relative;
    }

    .book-row::-webkit-scrollbar {
      height: 8px;
    }

    .book-row::-webkit-scrollbar-track {
      background: #F5F5DC;
      border-radius: 4px;
    }

    .book-row::-webkit-scrollbar-thumb {
      background: #A0522D;
      border-radius: 4px;
    }

    .book-row::-webkit-scrollbar-thumb:hover {
      background: #8B4513;
    }

    /* Sürükleme ipuçları */
    .book-row::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 20px;
      background: linear-gradient(to right, rgba(139, 69, 19, 0.1), transparent);
      pointer-events: none;
      z-index: 1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .book-row::after {
      content: '';
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 20px;
      background: linear-gradient(to left, rgba(139, 69, 19, 0.1), transparent);
      pointer-events: none;
      z-index: 1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .book-row:hover::before,
    .book-row:hover::after {
      opacity: 1;
    }

    /* Sürükleme sırasında görsel geri bildirim */
    .book-row.dragging {
      cursor: grabbing !important;
    }

    .book-row.dragging .book-card {
      pointer-events: none;
      transform: scale(0.98);
      transition: transform 0.1s ease;
    }

    /* Book Card */
    .book-card {
      background: #FFF8DC;
      border-radius: 12px;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      border: 2px solid #DEB887;
      min-width: 200px;
      max-width: 200px;
      flex-shrink: 0;
      height: 400px;
      display: flex;
      flex-direction: column;
    }

    .book-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(139, 69, 19, 0.4);
      border-color: #A0522D;
    }

    .book-image {
      width: 100%;
      height: 250px;
      object-fit: cover;
      background: #DEB887;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #8B4513;
      font-size: 0.9rem;
      flex-shrink: 0;
    }

    .book-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 0;
    }

    .book-info {
      padding: 15px;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 150px;
      background: #FFF8DC;
    }

    .book-title {
      font-weight: 600;
      font-size: 1rem;
      margin-bottom: 8px;
      color: #8B4513;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      min-height: 40px;
    }

    .book-author {
      color: #A0522D;
      font-size: 0.9rem;
      margin-bottom: 8px;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .book-category {
      background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
      color: white;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 0.8rem;
      display: inline-block;
      align-self: flex-start;
      margin-top: auto;
      box-shadow: 0 2px 4px rgba(139, 69, 19, 0.3);
    }

    /* Sabit Kitap Öneri Butonu */
    .fixed-recommend-btn {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
      color: white;
      border: none;
      padding: 18px 60px;
      font-size: 1.3rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
      z-index: 100;
      border-radius: 50px;
      display: flex;
      align-items: center;
      gap: 15px;
      border: 3px solid #DEB887;
    }

    .fixed-recommend-btn:hover {
      background: linear-gradient(135deg, #A0522D 0%, #CD853F 100%);
      transform: translateX(-50%) translateY(-3px);
      box-shadow: 0 12px 35px rgba(139, 69, 19, 0.5);
      border-color: #F5DEB3;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(139, 69, 19, 0.6);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background-color: #FFF8DC;
      margin: 5% auto;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 600px;
      position: relative;
      animation: modalSlideIn 0.3s ease;
      max-height: 80vh;
      overflow-y: auto;
      border: 3px solid #DEB887;
      box-shadow: 0 15px 40px rgba(139, 69, 19, 0.4);
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .close {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      color: #8B4513;
      background: none;
      border: none;
      padding: 5px;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .close:hover {
      background: #DEB887;
      color: #8B4513;
    }

    /* Book Detail Modal */
    .book-detail-modal .modal-content {
      max-width: 500px;
    }

    .book-detail-header {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      align-items: flex-start;
    }

    .book-detail-image {
      width: 150px;
      height: 200px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 8px 20px rgba(139, 69, 19, 0.3);
      flex-shrink: 0;
      border: 2px solid #DEB887;
    }

    .book-detail-info h2 {
      color: #8B4513;
      margin-bottom: 10px;
      font-size: 1.5rem;
    }

    .book-detail-info p {
      color: #A0522D;
      margin-bottom: 8px;
      font-size: 1rem;
    }

    .book-detail-summary {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px solid #DEB887;
    }

    .book-detail-summary h3 {
      color: #8B4513;
      margin-bottom: 10px;
      font-size: 1.2rem;
    }

    .book-detail-summary p {
      color: #A0522D;
      line-height: 1.6;
      text-align: justify;
    }

    /* Recommendation Modal */
    .recommendation-modal .modal-content {
      max-width: 500px;
    }

    .modal h2 {
      margin-bottom: 20px;
      color: #8B4513;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .category-select {
      width: 100%;
      padding: 15px;
      border: 2px solid #DEB887;
      border-radius: 12px;
      font-size: 1.1rem;
      margin-bottom: 20px;
      background: #FFF8DC;
      font-weight: 500;
      color: #8B4513;
    }

    .category-select:focus {
      outline: none;
      border-color: #A0522D;
      box-shadow: 0 0 0 3px rgba(160, 82, 45, 0.2);
    }

    .get-recommendation-btn {
      width: 100%;
      background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
      color: white;
      border: none;
      padding: 15px;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 20px;
      border: 2px solid #DEB887;
    }

    .get-recommendation-btn:hover {
      background: linear-gradient(135deg, #A0522D 0%, #CD853F 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(139, 69, 19, 0.4);
    }

    /* Recommended Book Display */
    .recommended-book {
      background: #F5F5DC;
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      display: none;
      border: 2px solid #DEB887;
    }

    .recommended-book.active {
      display: block;
      animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .recommended-book img {
      max-width: 180px;
      height: auto;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.3);
      border: 2px solid #DEB887;
    }

    .recommended-book h3 {
      color: #8B4513;
      margin-bottom: 15px;
      font-size: 1.4rem;
    }

    .recommended-book p {
      color: #A0522D;
      margin-bottom: 8px;
      font-size: 1rem;
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 40px;
      color: #8B4513;
      font-size: 1.1rem;
    }

    .loading i {
      animation: spin 1s linear infinite;
      font-size: 2rem;
      margin-bottom: 15px;
      display: block;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Error */
    .error {
      text-align: center;
      padding: 40px;
      color: #DC143C;
      font-size: 1.1rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .book-card {
        min-width: 150px;
        max-width: 150px;
        height: 320px;
      }
      
      .book-image {
        height: 180px;
      }
      
      .book-info {
        min-height: 140px;
      }
      
      .book-title {
        min-height: 35px;
        font-size: 0.9rem;
      }
      
      .modal-content {
        margin: 10% auto;
        width: 95%;
        padding: 20px;
      }
      
      .book-detail-header {
        flex-direction: column;
        text-align: center;
      }
      
      .book-detail-image {
        width: 120px;
        height: 160px;
        margin: 0 auto;
      }
      
      .fixed-recommend-btn {
        bottom: 20px;
        padding: 15px 40px;
        font-size: 1.1rem;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1><i class="fas fa-book-open"></i> Kitap Önerilerim</h1>
      <p>Kitap dünyasında keşfe çıkın</p>
    </div>

    <!-- En Popüler Kitaplar -->
    <div class="book-section">
      <h2 class="section-title">
        <i class="fas fa-fire"></i>
        En Popüler Kitaplar
      </h2>
      <div class="book-row" id="popularBooks">
        <div class="loading">
          <i class="fas fa-spinner"></i>
          Kitaplar yükleniyor...
        </div>
      </div>
    </div>

    <!-- Yeni Eklenen Kitaplar -->
    <div class="book-section">
      <h2 class="section-title">
        <i class="fas fa-star"></i>
        Yeni Eklenenler
      </h2>
      <div class="book-row" id="newBooks">
        <div class="loading">
          <i class="fas fa-spinner"></i>
          Kitaplar yükleniyor...
        </div>
      </div>
    </div>

    <!-- Kategori 1 -->
    <div class="book-section">
      <h2 class="section-title">
        <i class="fas fa-heart"></i>
        Modern Roman
      </h2>
      <div class="book-row" id="category1">
        <div class="loading">
          <i class="fas fa-spinner"></i>
          Kitaplar yükleniyor...
        </div>
      </div>
    </div>

    <!-- Kategori 2 -->
    <div class="book-section">
      <h2 class="section-title">
        <i class="fas fa-graduation-cap"></i>
        Klasik Roman
      </h2>
      <div class="book-row" id="category2">
        <div class="loading">
          <i class="fas fa-spinner"></i>
          Kitaplar yükleniyor...
        </div>
      </div>
    </div>

    <!-- Kategori 3 -->
    <div class="book-section">
      <h2 class="section-title">
        <i class="fas fa-child"></i>
        Çocuk Romanı
      </h2>
      <div class="book-row" id="category3">
        <div class="loading">
          <i class="fas fa-spinner"></i>
          Kitaplar yükleniyor...
        </div>
      </div>
    </div>
  </div>

  <!-- Sabit Kitap Öneri Butonu -->
  <button class="fixed-recommend-btn" onclick="openRecommendationModal()">
    <i class="fas fa-magic"></i>
    Kitap Önerisi
  </button>

  <!-- Kitap Detay Modal -->
  <div id="bookDetailModal" class="modal book-detail-modal">
    <div class="modal-content">
      <button class="close" onclick="closeBookDetailModal()">&times;</button>
      <div class="book-detail-header">
        <img id="detailBookImage" class="book-detail-image" src="" alt="Kitap Görseli">
        <div class="book-detail-info">
          <h2 id="detailBookTitle"></h2>
          <p id="detailBookAuthor"></p>
          <p id="detailBookCategory"></p>
        </div>
      </div>
      <div class="book-detail-summary">
        <h3>Kitap Özeti</h3>
        <p id="detailBookSummary"></p>
      </div>
    </div>
  </div>

  <!-- Kitap Öneri Modal -->
  <div id="recommendationModal" class="modal recommendation-modal">
    <div class="modal-content">
      <button class="close" onclick="closeRecommendationModal()">&times;</button>
      <h2><i class="fas fa-magic"></i> Kitap Önerisi</h2>
      
      <select class="category-select" id="categorySelect">
        <option value="">Kategori seçiniz...</option>
        <option value="Modern Roman">Modern Roman</option>
        <option value="Klasik Roman">Klasik Roman</option>
        <option value="Çocuk Romanı">Çocuk Romanı</option>
        <option value="Distopik Roman">Distopik Roman</option>
        <option value="Felsefe">Felsefe</option>
        <option value="Kişisel Gelişim">Kişisel Gelişim</option>
        <option value="Tarihî Roman">Tarihî Roman</option>
        <option value="Bilimkurgu">Bilimkurgu</option>
        <option value="Şiir">Şiir</option>
        <option value="Tiyatro / Trajedi">Tiyatro / Trajedi</option>
        <option value="Psikolojik Roman">Psikolojik Roman</option>
        <option value="Macera Romanı">Macera Romanı</option>
        <option value="Biyografi / Anı">Biyografi / Anı</option>
      </select>
      
      <button class="get-recommendation-btn" onclick="getRecommendation()">
        <i class="fas fa-dice"></i> Öneri Al
      </button>
      
      <div class="recommended-book" id="recommendedBook">
        <img id="recBookImage" src="" alt="Kitap Görseli">
        <h3 id="recBookTitle"></h3>
        <p id="recBookAuthor"></p>
        <p id="recBookCategory"></p>
        <p id="recBookSummary" style="margin-top: 15px; font-style: italic; color: #888;"></p>
      </div>
    </div>
  </div>

  <!-- Reklam Modalı -->
  <div id="promoModal" class="modal" style="display:none;">
    <div class="modal-content" style="max-width:600px; min-width:320px; text-align:center; padding:48px 32px 40px 32px;">
      <button class="close" onclick="closePromoModal()" style="top:28px; right:28px; font-size:36px;">&times;</button>
      <div style="margin-top:10px; margin-bottom:40px;">
        <i class="fab fa-android" style="font-size:5rem; color:#388e3c;"></i>
      </div>
      <h2 style="color:#8B4513; margin-bottom:32px; font-size:2.3rem; font-weight:800; letter-spacing:1px;">Mobil uygulamamız yayında!</h2>
      <a id="googlePlayBtn" href="https://play.google.com/store/apps/details?id=ornek.link" target="_blank" style="display:inline-block; background:linear-gradient(90deg,#388e3c 0%,#4caf50 100%); color:white; font-size:1.5rem; font-weight:700; padding:22px 80px; border-radius:50px; box-shadow:0 8px 32px rgba(56,142,60,0.18); text-decoration:none; margin-bottom:10px; transition:background 0.2s,transform 0.2s; letter-spacing:0.5px;">
        <i class="fab fa-google-play" style="margin-right:16px; font-size:2rem; vertical-align:middle;"></i> Google Play
      </a>
    </div>
  </div>

  <script>
    let allBooks = [];

    // Sayfa yüklendiğinde kitapları yükle
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        console.log('Kitaplar yükleniyor...');
        const response = await fetch('/api/kitaplar');
        console.log('API yanıtı:', response);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        allBooks = await response.json();
        console.log('Yüklenen kitap sayısı:', allBooks.length);
        
        if (allBooks.length === 0) {
          throw new Error('Kitap verisi bulunamadı');
        }
        
        // Bölümleri doldur
        loadPopularBooks();
        loadNewBooks();
        loadCategoryBooks('Modern Roman', 'category1');
        loadCategoryBooks('Klasik Roman', 'category2');
        loadCategoryBooks('Çocuk Romanı', 'category3');
        
        // Sürükleme özelliğini etkinleştir
        enableDragScroll();
        
      } catch (error) {
        console.error('Hata:', error);
        showError('Kitaplar yüklenirken hata oluştu: ' + error.message);
      }
    });

    // Sürükleme özelliğini etkinleştir
    function enableDragScroll() {
      const bookRows = document.querySelectorAll('.book-row');
      
      bookRows.forEach(row => {
        let isDown = false;
        let startX;
        let scrollLeft;

        // Mouse events
        row.addEventListener('mousedown', (e) => {
          isDown = true;
          row.classList.add('dragging');
          row.style.cursor = 'grabbing';
          startX = e.pageX - row.offsetLeft;
          scrollLeft = row.scrollLeft;
        });

        row.addEventListener('mouseleave', () => {
          isDown = false;
          row.classList.remove('dragging');
          row.style.cursor = 'grab';
        });

        row.addEventListener('mouseup', () => {
          isDown = false;
          row.classList.remove('dragging');
          row.style.cursor = 'grab';
        });

        row.addEventListener('mousemove', (e) => {
          if (!isDown) return;
          e.preventDefault();
          const x = e.pageX - row.offsetLeft;
          const walk = (x - startX) * 2; // Scroll speed
          row.scrollLeft = scrollLeft - walk;
        });

        // Touch events for mobile
        row.addEventListener('touchstart', (e) => {
          isDown = true;
          row.classList.add('dragging');
          startX = e.touches[0].pageX - row.offsetLeft;
          scrollLeft = row.scrollLeft;
        });

        row.addEventListener('touchend', () => {
          isDown = false;
          row.classList.remove('dragging');
        });

        row.addEventListener('touchmove', (e) => {
          if (!isDown) return;
          e.preventDefault();
          const x = e.touches[0].pageX - row.offsetLeft;
          const walk = (x - startX) * 2;
          row.scrollLeft = scrollLeft - walk;
        });

        // Set initial cursor style
        row.style.cursor = 'grab';
        row.style.userSelect = 'none';
        row.style.webkitUserSelect = 'none';
        row.style.msUserSelect = 'none';
      });
    }

    // En popüler kitaplar (ilk 25)
    function loadPopularBooks() {
      if (!allBooks || allBooks.length === 0) return;
      const popularBooks = allBooks.slice(0, 25);
      displayBooks(popularBooks, 'popularBooks');
    }

    // Yeni eklenen kitaplar (son 20)
    function loadNewBooks() {
      if (!allBooks || allBooks.length === 0) return;
      const newBooks = allBooks.slice(-20);
      displayBooks(newBooks, 'newBooks');
    }

    // Kategori kitapları (ilgili kategorideki ilk 10 kitap)
    function loadCategoryBooks(category, containerId) {
      if (!allBooks || allBooks.length === 0) return;
      const categoryBooks = allBooks.filter(book => book.category === category);
      if (categoryBooks.length === 0) {
        document.getElementById(containerId).innerHTML = 
          `<div style=\"text-align: center; color: #666; padding: 20px;\">Bu kategoride kitap bulunamadı.</div>`;
        return;
      }
      const selectedBooks = categoryBooks.slice(0, 10);
      displayBooks(selectedBooks, containerId);
    }

    // Kitapları görüntüle
    function displayBooks(books, containerId) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';

      if (!books || books.length === 0) {
        container.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">Kitap bulunamadı.</div>';
        return;
      }

      books.forEach(book => {
        const bookCard = document.createElement('div');
        bookCard.className = 'book-card';
        bookCard.onclick = () => showBookDetail(book);
        
        const imageHtml = book.image ? 
          `<img src="${book.image}" alt="${book.title}" style="width: 100%; height: 100%; object-fit: cover;">` : 
          '<i class="fas fa-book" style="font-size: 3rem;"></i>';
        
        bookCard.innerHTML = `
          <div class="book-image">
            ${imageHtml}
          </div>
          <div class="book-info">
            <div class="book-title">${book.title}</div>
            <div class="book-author">${book.author || 'Bilinmiyor'}</div>
            <div class="book-category">${book.category || 'Belirtilmemiş'}</div>
          </div>
        `;
        
        container.appendChild(bookCard);
      });
    }

    // Kitap detaylarını modal'da göster
    function showBookDetail(book) {
      document.getElementById('detailBookImage').src = book.image || '';
      document.getElementById('detailBookTitle').textContent = book.title;
      document.getElementById('detailBookAuthor').textContent = `Yazar: ${book.author || 'Bilinmiyor'}`;
      document.getElementById('detailBookCategory').textContent = `Kategori: ${book.category || 'Belirtilmemiş'}`;
      document.getElementById('detailBookSummary').textContent = book.summary || 'Bu kitap için özet bulunmuyor.';
      
      document.getElementById('bookDetailModal').style.display = 'block';
    }

    // Kitap detay modal'ını kapat
    function closeBookDetailModal() {
      document.getElementById('bookDetailModal').style.display = 'none';
    }

    // Kitap öneri modal'ını aç
    function openRecommendationModal() {
      document.getElementById('recommendationModal').style.display = 'block';
      document.getElementById('recommendedBook').classList.remove('active');
    }

    // Kitap öneri modal'ını kapat
    function closeRecommendationModal() {
      document.getElementById('recommendationModal').style.display = 'none';
    }

    // Kitap önerisi al
    function getRecommendation() {
      const selectedCategory = document.getElementById('categorySelect').value;
      
      if (!selectedCategory) {
        alert('Lütfen bir kategori seçin!');
        return;
      }

      const categoryBooks = allBooks.filter(book => book.category === selectedCategory);
      
      if (categoryBooks.length === 0) {
        alert('Bu kategoride kitap bulunamadı!');
        return;
      }

      const randomBook = categoryBooks[Math.floor(Math.random() * categoryBooks.length)];
      
      // Önerilen kitabı göster
      const recBook = document.getElementById('recommendedBook');
      document.getElementById('recBookImage').src = randomBook.image || '';
      document.getElementById('recBookTitle').textContent = randomBook.title;
      document.getElementById('recBookAuthor').textContent = `Yazar: ${randomBook.author || 'Bilinmiyor'}`;
      document.getElementById('recBookCategory').textContent = `Kategori: ${randomBook.category || 'Belirtilmemiş'}`;
      document.getElementById('recBookSummary').textContent = randomBook.summary || '';
      
      recBook.classList.add('active');
    }

    // Modal dışına tıklandığında kapat
    window.onclick = function(event) {
      const bookDetailModal = document.getElementById('bookDetailModal');
      const recommendationModal = document.getElementById('recommendationModal');
      
      if (event.target === bookDetailModal) {
        closeBookDetailModal();
      }
      
      if (event.target === recommendationModal) {
        closeRecommendationModal();
      }
    }

    // Hata göster
    function showError(message) {
      const sections = ['popularBooks', 'newBooks', 'category1', 'category2', 'category3'];
      sections.forEach(sectionId => {
        const container = document.getElementById(sectionId);
        container.innerHTML = `<div class="error">${message}</div>`;
      });
    }

    // Reklam modalı açılışı
    window.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        document.getElementById('promoModal').style.display = 'block';
      }, 400); // 0.4 saniye sonra açılır
    });
    function closePromoModal() {
      document.getElementById('promoModal').style.display = 'none';
    }
  </script>
</body>
</html>
